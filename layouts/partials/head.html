<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ with .Site.Params.name }}{{ . }}{{ end }}{{ with .Site.Params.title }} &mdash; {{ . }}{{ end }}</title>
<meta name="description" content="{{ .Site.Params.bio | default .Site.Params.title | default "" }}">
{{- $favicon := .Site.Params.favicon | default "/favicon.svg" }}
<link rel="icon" href="{{ if hasPrefix $favicon "http" }}{{ $favicon }}{{ else }}{{ $favicon | relURL }}{{ end }}" type="image/svg+xml">

{{/* Open Graph */}}
<meta property="og:title" content="{{ .Site.Params.name | default .Site.Title }}{{ with .Site.Params.title }} &mdash; {{ . }}{{ end }}">
<meta property="og:description" content="{{ .Site.Params.bio | default "" }}">
{{- with .Site.Params.avatar }}
<meta property="og:image" content="{{ . | absURL }}">
{{- end }}
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:type" content="profile">

{{/* Twitter Card */}}
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="{{ .Site.Params.name | default .Site.Title }}">
<meta name="twitter:description" content="{{ .Site.Params.bio | default "" }}">
{{- with .Site.Params.avatar }}
<meta name="twitter:image" content="{{ . | absURL }}">
{{- end }}

{{/* CSS — inlined to eliminate blob fetch */}}
{{- $css := resources.Get "css/main.css" -}}
<style>{{ $css.Content | safeCSS }}</style>

{{/* Custom Fonts (opt-in) */}}
{{- if .Site.Params.customFonts }}
{{- $sansFont := .Site.Params.fontFamily | default "Inter" -}}
{{- $monoFont := .Site.Params.monoFont | default "" -}}
{{- $fontUrl := .Site.Params.fontUrl | default "" -}}
{{- $selfHost := not .Site.Params.disableSelfHostFonts -}}
{{- if $fontUrl }}
<link rel="stylesheet" href="{{ $fontUrl }}">
{{- else if and $selfHost (eq $sansFont "Inter") }}
{{/* Self-hosted fonts — no external requests */}}
<link rel="preload" href="{{ "fonts/inter.woff2" | relURL }}" as="font" type="font/woff2" crossorigin>
{{- if or (eq $monoFont "JetBrains Mono") (not $monoFont) }}
<link rel="preload" href="{{ "fonts/jetbrains-mono.woff2" | relURL }}" as="font" type="font/woff2" crossorigin>
{{- end }}
<style>
  @font-face {
    font-family: 'Inter';
    font-style: normal;
    font-weight: 400 800;
    font-display: swap;
    src: url('{{ "fonts/inter.woff2" | relURL }}') format('woff2');
  }
  {{- if or (eq $monoFont "JetBrains Mono") (not $monoFont) }}
  @font-face {
    font-family: 'JetBrains Mono';
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('{{ "fonts/jetbrains-mono.woff2" | relURL }}') format('woff2');
  }
  {{- end }}
</style>
{{- else }}
{{/* Fallback to Google Fonts for non-bundled fonts */}}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
{{- $families := printf "%s:wght@400;500;600;700;800" (replace $sansFont " " "+") -}}
{{- with $monoFont }}{{ $families = printf "%s&family=%s:wght@400;500;600;700" $families (replace . " " "+") }}{{ end -}}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family={{ $families }}&display=swap">
{{- end }}
<style>
  :root {
    --font-sans: '{{ $sansFont }}', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    {{- with $monoFont }}
    --font-mono: '{{ . }}', 'SF Mono', 'Cascadia Code', ui-monospace, monospace;
    {{- end }}
  }
</style>
{{- end }}

{{/* Background Image (opt-in) */}}
{{- with .Site.Params.backgroundImage }}
{{- $opacity := $.Site.Params.backgroundOpacity | default 0.85 }}
<style>
  body {
    background-image: url('{{ . }}');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    background-repeat: no-repeat;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: -1;
    background: var(--bg-0);
    opacity: {{ $opacity }};
  }
</style>
{{- end }}

{{/* Card Opacity — makes cards semi-transparent (useful with backgroundImage) */}}
{{- with .Site.Params.cardOpacity }}
{{- $transparent := printf "%.0f" (mul (sub 1.0 (float .)) 100) }}
<style>
  .bio-section,
  .link-card,
  .project-card,
  .wallet {
    background: color-mix(in srgb, var(--bg-1), transparent {{ $transparent }}%);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
</style>
{{- end }}

{{/* Custom Accent Color — derives all accent variants automatically */}}
{{- with .Site.Params.accentColor }}
<style>
  :root,
  [data-theme="light"] {
    --accent: {{ . }};
    --accent-hover: color-mix(in srgb, {{ . }}, white 25%);
    --accent-muted: color-mix(in srgb, {{ . }}, transparent 85%);
    --accent-subtle: color-mix(in srgb, {{ . }}, transparent 94%);
    --border-accent: color-mix(in srgb, {{ . }}, transparent 70%);
    --glow: color-mix(in srgb, {{ . }}, transparent 93%);
  }
</style>
{{- end }}
